## 网站维护说明文档

### 1. 网站更新（快速）

1. 在当前目录下命令行执行`pip install -r requirements.txt`
2. 运行`build`脚本：
   - `Windows`环境：运行`build.cmd`（或使用`git bash`运行`build.sh`）
   - `Linux`环境：运行`build.sh`

### 2. 网站更新详细步骤

1. 在当前目录下命令行执行`pip install -r requirements.txt`
2. 命令行执行`python update.py`，这会自动更新`docs`文件夹中的内容以及`mkdocs.yml`中的内容（更新`docs`时会先删除文件夹内所有内容，之后重新生成）
3. 命令行执行`mkdocs serve`，在弹出的本地url中查看网站效果（人工检查一下自动生成的网站是否有问题）
4. 若上一步没有问题，命令行执行`mkdocs build --clean`，这会在当前目录下生成一个名为`site`的文件夹
5. 复制`site`到父目录，并重命名为`docs`（删除原来的`docs`文件夹），完成

### 3. 关于网站和脚本

该文档以及自动化脚本都可供未来开发者阅读修改。

#### 3.1 网站

网站使用`mkdocs`开发，配置文件为`mkdocs.yml`，详细信息可以查看官方文档。

注意，`mkdocs`的两个主题都仅支持两级`nav`，而专业已经占了一级，因此将各课程的`README.md`与对应资源放进一个`markdown`文件夹中是一个简单有效的选择。详情查阅[mkdocs theme说明文档](https://www.mkdocs.org/user-guide/choosing-your-theme/)。

#### 3.2 自动化脚本

- 脚本大致功能：自动获取`CS_Courses`下各个专业对应文件夹下的`README.md`文档以及资源信息，将这些信息填入一个新的markdown文件，命名为`<课程名称>.md`，里面含有原`README.md`文档中的信息以及资源链接。（资源链接是自动构造的url，基于`raw.githubusercontent`），但该脚本并不能够自动运行，因此目前**网站需要相关人员每隔一段时间在本地手动维护。**
- 注意事项：脚本在获取文件信息时**采用的是遍历方法，而非递归**。遍历是基于整体文件目录组织形式进行的（如 <专业> —— <课程> —— <`README.md`，课程学习资源> —— `××.pdf`），在最后一级目录下，脚本只会识别具有某种后缀的文件，不会识别子目录，所以网站中记录的资源是`repo`中资源的子集，且若`repo`中某文件夹下的内容与规定的文件目录组织格式偏差较大，与该文件夹对应的网站相关内容可能会出现错误。因此请上传者自行检查文件目录组织形式是否符合规定，在生成网站时检查本地网站信息是否正确（`mkdocs serve`）。

